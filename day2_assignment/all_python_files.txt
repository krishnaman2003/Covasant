
# FILE: .\day2.py
"""
file_operations.py - Solutions for file operations questions
"""
import os
import glob

def find_largest_file(directory):
    """Question-3: Given a directory, find out the file Name having max size recursively"""
    max_size = 0
    max_file = None
    
    for root, dirs, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            file_size = os.path.getsize(file_path)
            if file_size > max_size:
                max_size = file_size
                max_file = file_path
    
    return max_file, max_size

def collect_filtered_files(directory, extension, output_file):
    """Question-4: Recursively go below a dir and based on filter, dump those files into single file"""
    with open(output_file, "wt") as f_out:
        for root, dirs, files in os.walk(directory):
            for file in files:
                if file.endswith(extension):
                    file_path = os.path.join(root, file)
                    f_out.write(f"\n# FILE: {file_path}\n")
                    
                    with open(file_path, "rt") as f_in:
                        lines = f_in.readlines()
                        f_out.writelines(lines)

# Directory to search
path = "."

# Question-3: Find largest file
largest, size = find_largest_file(path)
print(f"Largest file: {largest}, Size: {size} bytes")

# Question-4: Collect Python files
collect_filtered_files(path, ".py", "all_python_files.txt")
print("Python files collected in: all_python_files.txt")
# FILE: .\q2day1.py
D1 = {'ok': 1, 'nok': 2}
D2 = {'ok': 2, 'new': 3}

# Union of keys (value does not matter)
D_UNION = {key: D1.get(key, D2.get(key)) for key in set(D1) | set(D2)}

# Intersection of keys (value does not matter)
D_INTERSECTION = {key: D1[key] for key in set(D1) & set(D2)}

# Difference: D1 - D2 (keys in D1 but not in D2)
D_DIFFERENCE = {key: D1[key] for key in set(D1) - set(D2)}

# Merge: values are added for the same keys
D_MERGE = {key: D1.get(key, 0) + D2.get(key, 0) for key in set(D1) | set(D2)}

# Print the results
print("D_UNION =", D_UNION)
print("D_INTERSECTION =", D_INTERSECTION)
print("D1 - D2 =", D_DIFFERENCE)
print("D_MERGE =", D_MERGE)